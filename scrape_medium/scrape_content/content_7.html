<figure class="fn fo fp fq fr fs cl cm paragraph-image"><div class="ft fu fv fw ak"><div class="cl cm fm"><div class="gc r fv gd"><div class="ge r"><div class="fx fy cp t u fz ak eh ga gb"><img class="cp t u fz ak gf gg gh" src="https://miro.medium.com/max/60/1*RKryPeD5M_aKc_YATUEfyA.jpeg?q=20" width="4994" height="3329" role="presentation"></div><img class="fx fy cp t u fz ak gi" width="4994" height="3329" role="presentation"><noscript><img class="cp t u fz ak" src="https://miro.medium.com/max/9988/1*RKryPeD5M_aKc_YATUEfyA.jpeg" width="4994" height="3329" role="presentation"></noscript></div></div></div></div></figure><p id="7565" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">This past weekend (13 August 2017) I started on a quest to get some data from a cinema website here in Accra, Ghana. I thought this would have been easy, since the data is available publicly. I immediately opened the Chrome web inspector to see some markup like I have not seen in years.</p><figure class="fn fo fp fq fr fs cl cm paragraph-image"><div class="ft fu fv fw ak"><div class="cl cm gx"><div class="gc r fv gd"><div class="gy r"><div class="fx fy cp t u fz ak eh ga gb"><img class="cp t u fz ak gf gg gh" src="https://miro.medium.com/max/60/0*32PIKXI1GS2PrJ5s.png?q=20" width="855" height="390" role="presentation"></div><img class="fx fy cp t u fz ak gi" width="855" height="390" role="presentation"><noscript><img class="cp t u fz ak" src="https://miro.medium.com/max/1710/0*32PIKXI1GS2PrJ5s.png" width="855" height="390" role="presentation"></noscript></div></div></div></div></figure><h1 id="28cc" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">The Problem</h1><p id="2dbb" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">There was no structure to this data, the listings were just a bunch of <code class="gd hq hr hs ht b">&lt;p&gt;</code> tags with some nested <code class="gd hq hr hs ht b">&lt;span&gt;</code> and <code class="gd hq hr hs ht b">&lt;br&gt;</code> tags inside. This to me was a sign of a no go, I even went on to state that there was no way of getting this data in the <a href="http://slack.devcongress.org/" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">DevCongress</a> (you might be wondering what DevCongress is, more to come soon) slack group, along with a solution I wasn’t too sure would work.</p><figure class="fn fo fp fq fr fs cl cm paragraph-image"><div class="ft fu fv fw ak"><div class="cl cm hy"><div class="gc r fv gd"><div class="hz r"><div class="fx fy cp t u fz ak eh ga gb"><img class="cp t u fz ak gf gg gh" src="https://miro.medium.com/max/60/0*LuDDRLMwRunwXnoY.png?q=20" width="884" height="103" role="presentation"></div><img class="fx fy cp t u fz ak gi" width="884" height="103" role="presentation"><noscript><img class="cp t u fz ak" src="https://miro.medium.com/max/1768/0*LuDDRLMwRunwXnoY.png" width="884" height="103" role="presentation"></noscript></div></div></div></div></figure><h1 id="ced0" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">The Old Solution</h1><p id="72d0" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">After a few minutes of thinking it through, I realised there was a pattern even in the <code class="gd hq hr hs ht b">&lt;p&gt;</code> tags, when I did a count I noticed that each movie has around <strong class="gl ia">12</strong> nodes of <code class="gd hq hr hs ht b">&lt;p&gt;</code> which contained the data I would need for the movie. So now I could do a loop over the <code class="gd hq hr hs ht b">&lt;p&gt;</code> tags and count down from <strong class="gl ia">12</strong>, then reset the counter once we hit <strong class="gl ia">0</strong>.</p><h1 id="5b38" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">The Actual Solution</h1><p id="0759" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">Just when I finished writing this post, the data I was scraping changed and broke my solution, so I had to go back to the drawing board and come up with a new solution, which I think in turn has worked out to be a better and more robust solution.</p><p id="2bc1" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Instead of counting the <code class="gd hq hr hs ht b">&lt;p&gt;</code> tags, I have decided to use the <code class="gd hq hr hs ht b">&lt;hr&gt;</code> tags on the page as the breaking point between each movie, I have also decided to not use the method I was before by counting down from <strong class="gl ia">12</strong> to get the movie information. I have instead opted for checking the actual string I am looping over to test if it contains a certain word where possible. In other places I am using some crazy thinking to get the information I need.</p><p id="5c91" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Its now a bit clearer to me as to how to approach the problem, I then decided its time to start writing some code, I was thinking of doing this in Python as I had used <a href="https://www.crummy.com/software/BeautifulSoup/" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Beautiful Soup</a> in the past to do this sort of thing, but lately I have been doing more work in JavaScript and Node. So I did a quick search and I found <a href="https://hackernoon.com/cheerio-node-nodejs-tutorial-web-html-scraping-note-a4ceb37d9cbb" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">this article</a> using <a href="https://cheerio.js.org/" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Cheerio</a> and the Request library, I quickly started writing some code and couldn’t believe how easy the API was to use.</p><h1 id="23f7" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">Getting started with the necessary tooling</h1><p id="24c7" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">Lets start by installing the libraries we will need, also note I am using Node 8, so will be using new features of JavaScript where I see fit.</p><h1 id="0164" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">Requirements</h1><p id="dfc4" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">For this tutorial you will need the following libraries. At the time of writing these are the versions I used.</p><ul class=""><li id="2ea7" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw ib ic id">Cheerio (1.0.0-rc.2)</li><li id="7070" class="gj gk dc bk gl b gm ie go if gq ig gs ih gu ii gw ib ic id">Request (2.81.0)</li></ul><pre class="fn fo fp fq fr ij ik il"><span id="879e" class="im ha dc bk ht b eg in io r ip">npm install cheerio@^1.0.0-rc.2 request@^2.81.0</span></pre><p id="f913" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Now lets start requiring the libraries we need in order to get some data from the webpage.</p><pre class="fn fo fp fq fr ij ik il"><span id="189d" class="im ha dc bk ht b eg in io r ip">let fs = require('fs'); <br>let request = require('request'); <br>let cheerio = require('cheerio');</span></pre><p id="d2ed" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">You will notice I am also requiring the <code class="gd hq hr hs ht b">fs</code> library, we are doing this so that later on we don’t hit the API more times than necessary, we can cache the data and easily read from cache and do our scraping from that data.</p><p id="f697" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Now lets define a few variables to store the URL of the website we want to scrape and the name of the cache files.</p><pre class="fn fo fp fq fr ij ik il"><span id="ddea" class="im ha dc bk ht b eg in io r ip">const cinema = 'accra'; <br>const apiUrl = `http://silverbirdcinemas.com/${cinema}/`; <br>const cacheFile = `cache/${cinema}-silverbird.html`; <br>const outputCacheFile = `cache/${cinema}-silverbird.json`;</span></pre><h1 id="5b0b" class="gz ha dc bk bj hb de hc dg hd he hf hg hh hi hj hk">Lets Go!</h1><p id="b1c0" class="gj gk dc bk gl b gm hl go hm gq hn gs ho gu hp gw cu">We can now start defining our data structure that we want to deliver to our end user.</p><pre class="fn fo fp fq fr ij ik il"><span id="8a64" class="im ha dc bk ht b eg in io r ip">// main movie listing <br>let movieListings = { <br>    address: '',<br>    movies: []<br>};<br> <br>// each individual movie <br>let newMovieObj = {<br>    title: '',<br>    showtimes: [],<br>    synopsis: '',<br>    cast: [],<br>    runningTime: '',<br>    genre: [], <br>    rating: 'Unknown' <br>};</span></pre><p id="1f0c" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Here we have defined the properties our output data will conform to, so in the <code class="gd hq hr hs ht b">movieListings</code> structure, we are currently only storing the <em class="iq">address</em> of the cinema and a list of <em class="iq">movies</em>. While in the <code class="gd hq hr hs ht b">newMovieObj</code> we are storing all the attributes of the movie that we need.</p><p id="f591" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Lets start writing our code to make a request to get the <code class="gd hq hr hs ht b">apiUrl</code> and then cache it to the file system using the <code class="gd hq hr hs ht b">fs</code> library. We will start off by wrapping the function so we can reuse it later on.</p><pre class="fn fo fp fq fr ij ik il"><span id="d2b4" class="im ha dc bk ht b eg in io r ip">let requestPage = (url, cachePath) =&gt; { <br>    request(url, (err, response, html) =&gt; { <br>        if (err) { <br>            return console.log(err); <br>        } <br>        fs.writeFile(cachePath, html, err =&gt; { <br>            if (err) { <br>                return console.log(err); <br>            } <br>            console.log('The file was saved!'); <br>        });<br>    });<br>};</span></pre><p id="a6be" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Lets look at some of this code, we start off by defining our function called <code class="gd hq hr hs ht b">requestPage</code>, which requires two parameters, one for the <code class="gd hq hr hs ht b">url</code> we are making the request to and another for the <code class="gd hq hr hs ht b">cachePath</code> we wish to save the response data to. We know what we are requesting is html so we will save it as html as defined in the <code class="gd hq hr hs ht b">cacheFile</code> variable we set earlier. We call the <code class="gd hq hr hs ht b">request</code> library with the <code class="gd hq hr hs ht b">url</code> and a callback function with the parameters of <code class="gd hq hr hs ht b">err, response, html</code>, with these we can determine the state of the request we’ve made. If there is an error, we just log it to the console for now, otherwise we can move on to starting to write to the filesystem. We now have some data, so lets move on to writing it to the filesystem for now with <code class="gd hq hr hs ht b">fs.writeFile</code>, in this we will also check for error and log them to the console again.</p><p id="793e" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Now that we have our function to request and write data to the filesystem, lets move on to reading the cache file we saved.</p><pre class="fn fo fp fq fr ij ik il"><span id="876b" class="im ha dc bk ht b eg in io r ip">fs.stat(cacheFile, (err, stat) =&gt; { <br>    if (!err) { <br>        fs.readFile(cacheFile, (err, data) =&gt; {}); <br>    } else if (err.code == 'ENOENT') { <br>        requestPage(apiUrl, cacheFile); <br>    } <br>});</span></pre><p id="108f" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">We start by checking if the <code class="gd hq hr hs ht b">cacheFile</code> exists, if it doesn’t we send a request and create one, otherwise we just read it using the <code class="gd hq hr hs ht b">fs.readFile</code> function.</p><p id="0b6d" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Inside our <code class="gd hq hr hs ht b">fs.readFile</code> callback, lets start loading up the data (which we know is an html page) into cheerio so we can crawl the DOM (Document Object Model) and select the data we need.</p><pre class="fn fo fp fq fr ij ik il"><span id="8d91" class="im ha dc bk ht b eg in io r ip">fs.readFile(cacheFile, (err, data) =&gt; { <br>    let $ = cheerio.load(data); <br>    let numLines = 10; <br>    let synopsisNext = false; <br>});</span></pre><p id="c801" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Lets take a look at this line by line.</p><pre class="fn fo fp fq fr ij ik il"><span id="41e7" class="im ha dc bk ht b eg in io r ip">let $ = cheerio.load(data);</span></pre><p id="f093" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">You might be wondering why are we assigning a <code class="gd hq hr hs ht b">$</code> variable to the loading of the DOM data, we are using the <code class="gd hq hr hs ht b">$</code> for no specific reason, except that its what jQuery uses and it became universal amongst most developers to represent the DOM.</p><pre class="fn fo fp fq fr ij ik il"><span id="264d" class="im ha dc bk ht b eg in io r ip">let numLines = 10;</span></pre><p id="4621" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">We assign the <code class="gd hq hr hs ht b">numLines</code> variable to <strong class="gl ia">10</strong>, because this is what we will use to figure out where our movie title is. So each time the <code class="gd hq hr hs ht b">numLines</code> is reduced to <strong class="gl ia">10</strong> we know its the node of a movie title.</p><pre class="fn fo fp fq fr ij ik il"><span id="b2bd" class="im ha dc bk ht b eg in io r ip">let movie = Object.assign({}, newMovieObj);</span></pre><p id="20ce" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">The <code class="gd hq hr hs ht b">movie</code> variable is assigned to a new copy of the <code class="gd hq hr hs ht b">newMovieObj</code> to get all the properties in that object.</p><pre class="fn fo fp fq fr ij ik il"><span id="02c6" class="im ha dc bk ht b eg in io r ip">let synopsisNext = false;</span></pre><p id="76b1" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">This <code class="gd hq hr hs ht b">synopsisNext</code> variable is to make sure that we know when the synopsis information is coming up, since the actual information and the title word <strong class="gl ia">SYNOPSIS</strong> are stored in different <code class="gd hq hr hs ht b">&lt;p&gt;</code> tags.</p><pre class="fn fo fp fq fr ij ik il"><span id="c7c9" class="im ha dc bk ht b eg in io r ip">$('#content .page').children().each((i, elem) =&gt; {<br>    let text = $(elem).text();<br>    let html = $(elem).html();<br>    if (i &gt;= 1 &amp;&amp; i &lt; 3) {<br>        movieListings.address += text.replace("\'", '');<br>    }<br>    <br>    // Movies start<br>    if (i &gt; 12) {<br>        if (html == '') {<br>            if (movie.title !== '') {<br>                movieListings.movies.push(movie);<br>            }<br>            numLines = 11; // offset by 1 in order to get movie title<br>            movie = Object.assign({}, newMovieObj);<br>        }<br>        <br>        // The movie title should be the first item in the loop<br>        if (numLines == 10) {<br>            movie.title = text.replace('\n ', '').trim();<br>        }</span><span id="4522" class="im ha dc bk ht b eg ir is it iu iv io r ip">if (checkDaysOfWeek(text, ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'])) {<br>            movie.showtimes = text.split('\n').map(item =&gt; item.trim());<br>        }</span><span id="5811" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for SYNOPSIS keyword and know that the next loop<br>        // will be the actual synopsis<br>        if (synopsisNext) {<br>            movie.synopsis = text;<br>            synopsisNext = false;<br>        }</span><span id="5d22" class="im ha dc bk ht b eg ir is it iu iv io r ip">if (text.indexOf('SYNOPSIS') === 0) {<br>            synopsisNext = true;<br>        }</span><span id="1017" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for the CASTS keyword<br>        if (text.indexOf('CASTS:') === 0) {<br>            movie.cast = (text.replace('CASTS:', '').trim()).split(',').map(item =&gt; item.trim());<br>        }</span><span id="1dea" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for RUNNING TIME keyword<br>        if (text.indexOf('RUNNING TIME:') === 0) {<br>            movie.runningTime = text.replace('RUNNING TIME:', '').trim();<br>        }</span><span id="c5fb" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for GERNE keyword<br>        if (text.indexOf('GENRE:') === 0) {<br>            movie.genre = (text.replace('GENRE:', '').trim()).split(',').map(item =&gt; item.trim());<br>        }</span><span id="504a" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for RATING keyword<br>        if (text.indexOf('RATING:') === 0) {<br>            movie.rating = text.replace('RATING:', '').trim();<br>        }<br>        numLines--;<br>    }<br>});</span></pre><p id="df7c" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">The code above is plenty, but lets break it down as to what each part is doing.</p><p id="ad5d" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">We will start off on line 1 which loops through all the <code class="gd hq hr hs ht b">p</code> tags inside of a <code class="gd hq hr hs ht b">div</code> with the <strong class="gl ia">id</strong> of <code class="gd hq hr hs ht b">content</code>.</p><pre class="fn fo fp fq fr ij ik il"><span id="fd48" class="im ha dc bk ht b eg in io r ip">$('#content .page').children().each((i, elem) =&gt; {</span></pre><p id="0f70" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">On line 2 and 3 we are assigning the text of each <code class="gd hq hr hs ht b">p</code> tag into a variable called <code class="gd hq hr hs ht b">text</code> and a variable called <code class="gd hq hr hs ht b">html</code>.</p><pre class="fn fo fp fq fr ij ik il"><span id="48e4" class="im ha dc bk ht b eg in io r ip">let text = $(elem).text(); <br>let html = $(elem).html();</span></pre><p id="d04d" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">From line 4 we are then checking if the current <code class="gd hq hr hs ht b">p</code> tag is situated in the first 3, as we have figured this is where the address for the cinema is located. We then append that text to the <code class="gd hq hr hs ht b">address</code> property of the <code class="gd hq hr hs ht b">movieListings</code> object. At this point we do some cleanup on the text with the <code class="gd hq hr hs ht b">replace</code> string method.</p><pre class="fn fo fp fq fr ij ik il"><span id="3e94" class="im ha dc bk ht b eg in io r ip">if (i &gt;= 1 &amp;&amp; i &lt; 3) { <br>    movieListings.address += text.replace("\'", '');<br>}</span></pre><p id="bc9a" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Next we can see that the actual movie listings start from line 9 onwards, this is because we know that after 12 <code class="gd hq hr hs ht b">p</code> tags we have the movie listings starting.</p><pre class="fn fo fp fq fr ij ik il"><span id="217e" class="im ha dc bk ht b eg in io r ip">if (i &gt; 12) {</span></pre><p id="682b" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">On line 10 to 16, we check if <code class="gd hq hr hs ht b">html</code> is empty and reset <code class="gd hq hr hs ht b">numLines</code> to 11, you might be wondering why 11 instead of 10, this is because we have to offset by 1 in order to get any subsequent title after the first time, now we add the current <code class="gd hq hr hs ht b">movie</code> to the <code class="gd hq hr hs ht b">movieListings.movies</code>. We then move on to creating a new <code class="gd hq hr hs ht b">movie</code> object to make sure that our next loop is not updating an existing movie reference.</p><pre class="fn fo fp fq fr ij ik il"><span id="e550" class="im ha dc bk ht b eg in io r ip">if (html == '') { <br>    if (movie.title !== '') { <br>        movieListings.movies.push(movie);<br>    } <br>    numLines = 11; <!-- -->// offset by 1 in order to get movie title</span><span id="5dfb" class="im ha dc bk ht b eg ir is it iu iv io r ip">movie = Object.assign({}, newMovieObj);<br>}</span></pre><p id="43af" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">On line 19 to 56, we use multiple <code class="gd hq hr hs ht b">if</code> statements to decide which piece of movie information we are currently accessing. Here you will notice we are using different methods to check the data against. When we find the information we need, we are doing some manipulation and cleanup in order to create a format we are happy with. In this particular area we created a helper function to get the showtimes, by check a string to see if it contains any of the days in the week. That helper function is the <code class="gd hq hr hs ht b">checkDaysOfWeek</code> function, which looks like the below.</p><pre class="fn fo fp fq fr ij ik il"><span id="d072" class="im ha dc bk ht b eg in io r ip">let checkDaysOfWeek = (text, days) =&gt; { <br>    for (var i = 0; i &lt; days.length; i++) { <br>        if (text.toLowerCase().indexOf(days[i]) !== -1) { <br>            return true; <br>        } <br>    } <br>    return false; <br>};</span></pre><p id="45c0" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">The rest of the code below is just working out how best to find a particular piece of movie information.</p><pre class="fn fo fp fq fr ij ik il"><span id="61ef" class="im ha dc bk ht b eg in io r ip">// The movie title should be the first item in the loop<br>if (numLines == 10) {<br>    movie.title = text.replace('\n ', '').trim();<br>}</span><span id="12ab" class="im ha dc bk ht b eg ir is it iu iv io r ip">if (checkDaysOfWeek(text, ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'])) {<br>    movie.showtimes = text.split('\n').map(item =&gt; item.trim());<br>}</span><span id="9d3d" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for SYNOPSIS keyword and know that the next loop<br>// will be the actual synopsis<br>if (synopsisNext) {<br>    movie.synopsis = text;<br>    synopsisNext = false;<br>}</span><span id="865c" class="im ha dc bk ht b eg ir is it iu iv io r ip">if (text.indexOf('SYNOPSIS') === 0) {<br>    synopsisNext = true;<br>}</span><span id="55ea" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for the CASTS keyword<br>if (text.indexOf('CASTS:') === 0) {<br>    movie.cast = (text.replace('CASTS:', '').trim()).split(',').map(item =&gt; item.trim());<br>}</span><span id="e3c6" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for RUNNING TIME keyword<br>if (text.indexOf('RUNNING TIME:') === 0) {<br>    movie.runningTime = text.replace('RUNNING TIME:', '').trim();<br>}</span><span id="8747" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for GERNE keyword<br>if (text.indexOf('GENRE:') === 0) {<br>    movie.genre = (text.replace('GENRE:', '').trim()).split(',').map(item =&gt; item.trim());<br>}</span><span id="e15b" class="im ha dc bk ht b eg ir is it iu iv io r ip">// Search for RATING keyword<br>if (text.indexOf('RATING:') === 0) {<br>    movie.rating = text.replace('RATING:', '').trim();<br>}</span></pre><p id="8195" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Once we hit line 57, we reduce by 1 the <code class="gd hq hr hs ht b">numLines</code> left.</p><pre class="fn fo fp fq fr ij ik il"><span id="7fe9" class="im ha dc bk ht b eg in io r ip">numLines--;</span></pre><p id="d976" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">You can view the full source code and working copy on <a href="https://glitch.com/edit/#!/sunrise-alloy" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Glitch</a>.</p><p id="1d30" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">And this is how I went about scraping the movie data I needed from the cinema website. In the code there are a lot of places that can be refactored and simplified. I might write another post on refactoring the current codebase.</p><p id="ebee" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu">Thanks to <a href="https://twitter.com/micheallshair" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Wendy Smith</a>, <a href="https://twitter.com/Eddy_mens" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Edmond Mensah</a>, <a href="https://twitter.com/elartey" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">Emmanuel Lartey</a> and <a href="https://twitter.com/theRealBraZee" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">David Oddoye</a> for reviewing this post and giving feedback to improve it. If you need Front-end/NodeJS/PHP development done, please visit <a href="https://www.donielsmith.com/" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">https://www.donielsmith.com</a> and check out some of my work. Feel free to get in-touch with me on Twitter <a href="https://twitter.com/silentworks" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow">@silentworks</a> with questions.</p><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><p id="56b5" class="gj gk dc bk gl b gm gn go gp gq gr gs gt gu gv gw cu"><em class="iq">Originally published at </em><a href="https://www.donielsmith.com/blog/2017/08/29/how-to-do-web-scraping-with-cheerio/" class="at cg hu hv hw hx" target="_blank" rel="noopener nofollow"><em class="iq">www.donielsmith.com</em></a><em class="iq"> on August 29, 2017.</em></p></div></div></section>