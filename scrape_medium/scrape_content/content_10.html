<p id="3c31" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Web scraping is a popular method of automatically collecting the information from different websites. It allows you to quickly obtain the data without the necessity to browse through the numerous pages and copy and paste the data. Later, it is outputted into a CSV file with structured information. Scraping tools are also capable of actualizing the changing information.</p><p id="5d6c" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">There are numerous applications, websites, and browser plugins allowing you to parse the information quickly and efficiently. It is also possible to create your own web scraper — this is not as hard as it may seem.</p><p id="3d3a" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">In this article, you will learn more about web scraping, its types, and possible applications. We will also tell you how to scrape websites with Ruby.</p><h1 id="e1fd" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Ways of collecting the information</h1><p id="d904" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">There are two ways to automatically collect the information: web scraping and web crawling. They are both used for extracting the content from websites, but the areas of work are different.</p><p id="78a7" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">Web scraping</strong> refers to collecting the data from a particular source (website, database) or a local machine. It does not involve working with large datasets, and a simple download of the web page is considered to be a sort of data scraping.</p><p id="90e6" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">Web crawling</strong> implements processing large sets of data on numerous resources. The crawler attends the main page of the website and gradually scans the entire resource. Generally, the bot is programmed to attend numerous sites of the same type (for example, internet furniture shops).</p><p id="4558" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Both processes result in presenting the output of the collected information. Since the Internet is an open network, and the same content can be reposted on different resources, the output can contain lots of duplicated information. Data crawling involves processing the output and removing the duplicates. This can also be done while scraping the information, but it is not necessarily part of it.</p><h1 id="3b93" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">How web scraping works and how to choose the tool</h1><p id="9688" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">The scraping scripts are executed according to the following algorithm: the program attends the web page and selects the necessary HTML-elements according to the settled CSS- or XPath-selectors. The necessary information is processed, and the result is saved in the document.</p><p id="c934" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">The web provides quite a lot of out-of-box scraping tools like online and desktop applications, browser extensions, etc. They provide different functionalities that are suitable for different needs. That is why choosing a web scraper requires a bit of market research. Let’s have a look at the key features to consider when choosing a web scraping tool.</p><p id="cdb4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">The different scrapers process different types of information: articles, blog and forum comments, internet shop databases, tables, dropdowns, Javascript elements, etc. The result can also be presented in different formats, like XML or CSV, or be written right into a database.</p><p id="5ef1" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">The out-of-box scrapers can provide a free and commercial license. The free tools generally have fewer options for customization, less capacity, and less thorough scraping. The paid scrapers offer wider functionality and efficiency of work and are perfectly suited for professional usage.</p><ul class=""><li id="230f" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Technical background for usage</strong></li></ul><p id="57bf" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Some of the tools can be used just via the visual interface, without writing any lines of code. The other ones require a basic technical background. There are also tools for advanced computer users. The difference between them is in the customization options.</p><p id="848b" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">It is also possible to develop a custom web scraper from scratch. The application can be written on any of the existing programming languages, including Ruby. The custom Ruby parser will have all the necessary functionality and the output information will be pre-processed exactly the way you need it.</p><p id="a4aa" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Having considered the existing types of web scraping tools, let’s see how to choose a scraper according to your needs:</p><ul class=""><li id="cf52" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu">A <strong class="fo gr">free out-of-box tool</strong> will be sufficient for processing small amounts of information for personal use.</li><li id="bdf8" class="fm fn dc bk fo b fp gv fr gw ft gx fv gy fx gz fz gs gt gu">A scraper with a <strong class="fo gr">paid license</strong> is necessary for users collecting large, yet similar sets for information for business and scientific needs (e.g. collecting financial statistics).</li><li id="6575" class="fm fn dc bk fo b fp gv fr gw ft gx fv gy fx gz fz gs gt gu">A <strong class="fo gr">customized tool </strong>for scraping the web with Ruby is suitable for users who need a fully customized tool for professional scraping tasks on a regular basis.</li></ul><h1 id="89bb" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">The application of web scraping</h1><p id="947a" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Data scraping and crawling are used for processing sets of unstructured information and logically presenting them as a database or a spreadsheet. The output is valuable information for analysts and researchers, and it can be applied in many different areas.</p><p id="54d4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">The Ruby web crawler can collect the information from different resources, and output the dynamics of market changes (such as changes of currency rates, prices for securities, oil, gold, estate, etc). The output can then be used for predictive analytics and training of artificial intelligence.</p><ul class=""><li id="d86f" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Collecting product characteristics and prices</strong></li></ul><p id="a4f5" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Web scraping is widely used by aggregators — they collect the information about the goods in different internet shops, and later present it on their websites. This gives the users the opportunity to compare the prices and characteristics of the necessary item on different platforms without having to browse through numerous sites.</p><ul class=""><li id="2d08" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Collecting contact details</strong></li></ul><p id="2575" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Web scraping can be useful for establishing both B2B and B2C relationships. With the help of scraping tools, companies can create lists of suppliers, partners, etc., and collect the databases of existing and potential clients. In other words, web scraping can help to obtain the lists of any individuals of interests.</p><ul class=""><li id="bc51" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Collecting job opportunities</strong></li></ul><p id="e567" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Recruitment companies can extract the contact details of potential applicants for different vacancies, and vice versa — the information about job opportunities in different companies can be collected as well. This output is a good base not only for finding the necessary specialists and jobs, but also for market analysis, creating statistics about the demand and requirements for the different specialists, their salary rates, etc.</p><ul class=""><li id="acd0" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Collecting information on a topic</strong></li></ul><p id="c1c0" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">With the help of scraping, you can download all the necessary information in bulk and then use it offline. For example, it is possible to extract all the questions and answers on a particular topic from Quora or any other service for questions and answers. You can also collect blog posts or the results of internet searches.</p><ul class=""><li id="4f2b" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><strong class="fo gr">Conducting market research</strong></li></ul><p id="14d0" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Data scraping can be applied by marketing specialists for conducting research on a target audience, collecting the email base for newsletters, etc. It helps to monitor competitors’ activities and track if they are changing their catalogs. SEO specialists can also scrape the web pages of competitors in order to analyze the semantics of the website.</p><h1 id="815f" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">How to do web scraping using Ruby</h1><p id="c861" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Having considered the variety of web scraping tools and the possible ways to apply the scraped data, now let’s talk about creating your own custom tool. We are going to present you with a brief guide covering the basic stages of web scraping in Ruby.</p><h1 id="2a90" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Useful tools</h1><p id="e5ab" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">This language provides a wide range of ready-made tools for performing typical operations. They allow developers to use official and reliable solutions instead of reinventing the wheel. For Ruby web scraping, you will need to install the following gems on your computer:</p><ul class=""><li id="e564" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz gs gt gu"><a href="https://rubygems.org/gems/nokogiri/versions/1.6.6.2" class="at cg ha hb hc hd" target="_blank" rel="noopener nofollow">NokoGiri</a> is an HTML, SAX and RSS parser providing access to the elements based on XPath and CSS3-selectors. This gem can be applied not only for web parsing but also for processing different types of XML files.</li><li id="4298" class="fm fn dc bk fo b fp gv fr gw ft gx fv gy fx gz fz gs gt gu"><a href="https://rubygems.org/gems/httparty" class="at cg ha hb hc hd" target="_blank" rel="noopener nofollow">HTTParty</a> is a client for RESTful services, sending HTTP queries to the scrapped pages and automatic parsing of JSON and XML files to your Ruby storage.</li><li id="690e" class="fm fn dc bk fo b fp gv fr gw ft gx fv gy fx gz fz gs gt gu"><a href="https://rubygems.org/gems/pry" class="at cg ha hb hc hd" target="_blank" rel="noopener nofollow">Pry</a> is a tool used for debugging. It will help us to parse the code from the scrapped pages.</li></ul><p id="51a2" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Web scraping is quite a simple operation and, generally, there is no need to install the Rails framework for this. However, it does make sense if the scraper is part of a more complicated service.</p><p id="d63f" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Having installed the necessary gems, you are now ready to learn how to make a web scraper. Let’s proceed!</p><h1 id="3ac1" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Step 1. Creating the scraping file</h1><p id="a9d3" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Create the directory where the application data will be stored. Then add a blank text file named after the application and save it to the folder. Let’s call it “web_scraper.rb”.</p><p id="44c9" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">In the file, integrate the Nokogiri, HTTParty and Pry gems by running these commands:</p><p id="5f4e" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">require ‘nokogiri’</strong></p><p id="87e7" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">require ‘httparty’</strong></p><p id="b9c4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">require ‘pry’</strong></p><h1 id="6a88" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Step 2. Sending the HTTP-queries</h1><p id="750c" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Create a variable and send the HTTP-request to the page you are going to scrape:</p><p id="bdf5" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">page = HTTParty.get(‘https://www.iana.org/domains/reserved’)</strong></p><h1 id="7fb3" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Step 3. Launching NokoGiri</h1><p id="c025" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">The aim of this stage is to convert the list items into Nokogiri objects for further parsing. Set a new variable named “parsed_page” and make it equal to the Nokogiri method of converting the HTML data to objects — you will use it throughout the process.</p><p id="a29a" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">parsed_page = Nokogiri::HTML(page)</strong></p><p id="2892" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">Pry.start(binding)</strong></p><p id="aef0" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Save your file and launch it once again. Execute a “parsed_page” variable for retrieving the necessary page as the set of Nokogiri objects.</p><p id="39e4" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">In the same folder, create an HTML file (let’s call it “output”), and save the result of “parse page command” there. You will be able to refer to this document later.</p><p id="3e06" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Before proceeding, exit from Pry in the terminal.</p><h1 id="b001" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Step 4. Parsing</h1><p id="49b5" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Now you need to extract all the needed list items. To do this, select the necessary CSS item and enter it to the Nokogiri output. You can locate the selector by viewing the page’s source code:</p><p id="067d" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">array = parsed_page.css(‘h2’).map(&amp;:text)</strong></p><p id="fa54" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">Once the parsing is complete, it is necessary to export the parsed data to the CSV file so it won’t get lost.</p><h1 id="64e9" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Step 5. Export</h1><p id="1b77" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">Having parsed the information, you need to complete the scraping and convert the data into a structured table. Return to the terminal and execute the commands:</p><p id="ade7" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">require ‘csv’</strong></p><p id="1a24" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><strong class="fo gr">CSV.open(‘reserved.csv’, ‘w’) { |csv| csv &lt;&lt; array }</strong></p><p id="ece9" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu">You will receive a new CSV file with all the parsed data inside.</p><h1 id="ec00" class="ga gb dc bk bj gc de gd dg ge gf gg gh gi gj gk gl">Conclusion</h1><p id="dd80" class="fm fn dc bk fo b fp gm fr gn ft go fv gp fx gq fz cu">We have covered the process of web scraping, its types, benefits, and possible applications. You are now aware of the basic features of the existing tools and know how to choose right one. If your business needs a customized solution, drop us a line. Our developers will create an application for web scraping on Ruby on Rails that will perfectly satisfy your needs.</p><section class="cu cv cw cx cy"><div class="n p"><div class="ac ae af ag ah cz aj ak"><p id="80bf" class="fm fn dc bk fo b fp fq fr fs ft fu fv fw fx fy fz cu"><em class="ho">Originally published at </em><a href="https://sloboda-studio.com/blog/how-to-do-web-scraping-with-ruby/" class="at cg ha hb hc hd" target="_blank" rel="noopener nofollow"><em class="ho">sloboda-studio.com</em></a><em class="ho"> on August 20, 2018.</em></p></div></div></section>